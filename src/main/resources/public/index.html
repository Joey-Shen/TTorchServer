<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>TTorch</title>

    <style type="text/css">

        #map {
            width: 1000px;
            height: 500px;
            margin-top: 50px;
            margin-left: 250px;
        }

    </style>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
    <link rel="stylesheet" href="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css" />
</head>
<body>

<div style="width: 65%; margin-left:300px; background-color: powderblue">
    <div class="btn-group" style="margin-top: 50px; margin-left: 180px" role="group" aria-label="Basic example">
        <button id="btn0" type="button" style="margin-right: 1px" class="btn btn-primary" value=0>Similarity Search
        </button>
        <button id="btn1" type="button" style="margin-right: 1px" class="btn btn-secondary" value=1>Range Search
        </button>
        <button id="btn2" type="button" style="margin-right: 1px" class="btn btn-secondary" value=2>Path Query</button>
        <button id="btn3" type="button" style="margin-right: 1px" class="btn btn-secondary" value=3>Strict Path Query
        </button>
    </div>

    <div class="input-group mb-3" style="margin-top: 20px; margin-right:10px">
        <input type="text" id="input" class="form-control" size="25" placeholder="draw the window for RangeSearch, or the path for other types of queries"
               aria-label="search" aria-describedby="button-addon4" style="margin-left: 50px">
        <div class="input-group-append" id="button-addon4">
            <button class="btn btn-outline-danger" id="btnClear" type="button">Clear</button>
            <button class="btn btn-outline-success" id="btnSearch" style="margin-left: 1px" type="button">Search
            </button>
        </div>
    </div>

    <div id="info" class="alert alert-warning" role="alert" style="margin-left: 220px; width: 450px; font-size: medium; display: none">
        <p style="align-content: center ">A simple warning alert—check it out!</p>
    </div>
</div>

<div id="map"></div>
<canvas id="canvas"></canvas>

<!-- JavaScript field -->
<script src="https://code.jquery.com/jquery-3.3.1.js"
        integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js"
        integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em"
        crossorigin="anonymous"></script>
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=o55gGAr8In322oxznMl5cojFABFo5hjE"></script>
<script type="text/javascript"
        src="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js"></script>
<script src="http://mapv.baidu.com/build/mapv.min.js"></script>
<script type="text/javascript">

    const SIMILARITY_SEARCH = 0;
    const RANGE_SEARCH = 1;
    const PATH_QUERY = 2;
    const STRICT_PATH_QUERY = 3;

    const urlPrefix = "http://localhost:8080";
    const apiMap = {
        0:"/TTorchServer/API/TKQ",
        1:"/TTorchServer/API/RQ",
        2:"/TTorchServer/API/PQ",
        3:"/TTorchServer/API/SPQ"
    };

    $(document).ready(() => {

        // set listeners for query type selection group
        // record current selected btn.
        // 0 -- similarity search btn
        // 1 -- range search btn
        // 2 -- path query btn
        // 3 -- strict path query btn;
        let curBtnState = 0;
        for (let i = 0; i <= 3; i++) {
            let curBtn = $('#btn' + i);
            curBtn.click(() => {
                if (curBtnState !== i) {
                    $('#btn'+curBtnState).removeClass("btn-primary").addClass("btn-secondary");
                    curBtn.removeClass("btn-secondary").addClass("btn-primary");
                    curBtnState = parseInt(curBtn.val());
                }
            });
        }

        // baidu API
        let map = new BMap.Map("map");    // 创建Map实例
        map.centerAndZoom(new BMap.Point(-8.630568, 41.154795), 14);  // 初始化地图,设置中心点坐标和地图级别
        map.enableScrollWheelZoom(true); // 开启鼠标滚轮缩放
        map.setMapStyle({style: 'light'});

        let path = "";                  // used for other query types
        let window = "";                // used for range query

        let pathStyle = {
            strokeColor: "red",
            strokeWeight: 1,             // width of the stroke
            strokeOpacity: 0.5,
            strokeStyle: "dashed"        // solid or dashed
        };

        let rectStyle = {
            strokeColor: "red",
            fillColor: "red",
            strokeOpacity: 0.3,
            fillOpacity: 0.3,
            strokeStyle: "solid"
        };

        let drawer = new BMapLib.DrawingManager(map, {
            isOpen: false,                          // disable drawing mode
            enableDrawingTool: true,                // display tool bar
            drawingToolOptions: {
                anchor: BMAP_ANCHOR_TOP_RIGHT,      // position of the tool bar
                offset: new BMap.Size(10, 40),        // offset from the position
                scale: 0.8,
                drawingModes: [                    // functions on tool bar
                    // BMAP_DRAWING_MARKER,
                    // BMAP_DRAWING_CIRCLE,
                    BMAP_DRAWING_POLYLINE,
                    // BMAP_DRAWING_POLYGON,
                    BMAP_DRAWING_RECTANGLE
                ]
            },
            polylineOptions: pathStyle,
            rectangleOptions: rectStyle
        });

        function clear1() {
            $("#input").val("");
            map.clearOverlays();
            let infoElement = $('#info');
            infoElement.text("");
            infoElement.hide();
            path = "";
            window = "";
        }

        function displayInfo( content) {
            let infoElement = $('#info');
            infoElement.text(content);
            infoElement.show();
        }

        let lineComplete = function(line){

            if (curBtnState !== RANGE_SEARCH) {
                let temp = line.getPath();
                path = "[";
                temp.forEach((item) => {
                    path += "[" + item.lat + "," + item.lng + "],"
                });
                path = path.substr(0, path.length - 1);
                path += "]";
                $("#input").val(path);
            }else{
                clear1();
                displayInfo("Current query type do not support a PATH as query!")
            }
        };

        let rectComplete = (rect) => {

            console.log("cur btn state: "+curBtnState);
            console.log("range search: "+RANGE_SEARCH);

            if (curBtnState === RANGE_SEARCH) {
                // 0 -- upper left
                // 1 -- upper right
                // 2 -- lower right
                // 3 -- lower left
                let temp = [
                    rect.getPath()[0],
                    rect.getPath()[2]
                ];
                window = "[";
                temp.forEach((item) => {
                    window += "[" + item.lat + "," + item.lng + "],"
                });
                window = window.substr(0, window.length - 1);
                window += "]";
                $("#input").val(window);
            }else{
                clear1();
                displayInfo("Current query type do not support a WINDOW as query!");
            }
        };

        drawer.addEventListener("polylinecomplete", lineComplete);

        drawer.addEventListener("rectanglecomplete", rectComplete);


        // todo set listeners for clear button and submit button
        $("#btnClear").click(()=>{
            clear1();
        });

        $("#btnSearch").click(()=>{

            let url = urlPrefix + apiMap[curBtnState];
            let data;
            console.log(url);
            if (curBtnState === RANGE_SEARCH){
                if (window === "") {
                    displayInfo("A window for the query is required!");
                    return;
                }

                if (window.split("],[").length !== 2) {
                    displayInfo("A window is defined by an upper left point and a lower right point");
                    return;
                }
                data = {query: window};
            } else {
                if (path === "") {
                    displayInfo("A path for the query is required!");
                    return;
                }

                if (path.split("],[").length < 2) {
                    displayInfo("A path is defined by two or more points");
                    return;
                }

                if (curBtnState === SIMILARITY_SEARCH) {
                    data = {
                        query: path,
                        k: 5
                    }
                }else {
                    data = {query: path};
                }
            }
            console.log(data);

            $.ajax({
                url: url,
                data: data,
                dataType:'json',
                cache: false,
                type: "GET",
                success: function(res) {
                    clear1();
                    console.log(res);
                },
                error: function(xhr) {
                    displayInfo("server unavailable");
                }
            });
        });

        // mapV API
        // draw retrieved trajecory data on map
        let data = [{
            "geometry": {
                "type": "LineString",
                "coordinates": [[-8.630568, 41.154795], [-8.63064, 41.154813], [-8.631495, 41.1543], [-8.632521, 41.152905], [-8.632539, 41.152815], [-8.633241, 41.152599], [-8.63586, 41.152428], [-8.637237, 41.152761], [-8.637264, 41.152788], [-8.638929, 41.153166], [-8.641692, 41.15385], [-8.644383, 41.154489], [-8.646048, 41.153985], [-8.645634, 41.153301], [-8.645418, 41.153148], [-8.645391, 41.15223], [-8.645454, 41.152122], [-8.645436, 41.152131], [-8.645355, 41.152284], [-8.645652, 41.153346], [-8.646075, 41.15412], [-8.64711, 41.154264], [-8.648082, 41.154615], [-8.64855, 41.156397], [-8.649513, 41.158791], [-8.648766, 41.15934], [-8.650287, 41.1606], [-8.650242, 41.161311], [-8.649027, 41.161185], [-8.646804, 41.160861], [-8.646786, 41.160861], [-8.646399, 41.161203], [-8.645247, 41.161464], [-8.643897, 41.161257], [-8.643753, 41.161995], [-8.64306, 41.164038], [-8.642763, 41.164947], [-8.642709, 41.164956], [-8.641737, 41.164983]]
            }, "fillStyle": "grey"
        }, {
            "geometry": {
                "type": "LineString",
                "coordinates": [[-8.630887984429776, 41.15471112328867], [-8.630920580720616, 41.15468690890119], [-8.631063818135793, 41.15458185571242], [-8.631063818135793, 41.15458185571242], [-8.631743683630459, 41.15406906949138], [-8.631743683630459, 41.15406906949138], [-8.631778887624566, 41.154042433665154], [-8.631778887624566, 41.154042433665154], [-8.631866245684018, 41.1539755647028], [-8.631866245684018, 41.1539755647028], [-8.631975582956722, 41.15388764784979], [-8.631975582956722, 41.15388764784979], [-8.63205772560964, 41.15379730955804], [-8.632142475965823, 41.15369411901446], [-8.632199845437702, 41.15360396698722], [-8.632199845437702, 41.15360396698722], [-8.632311045355596, 41.15349667862423], [-8.632317378349246, 41.153481963727224], [-8.63238983524717, 41.1532778178143], [-8.63238983524717, 41.1532778178143], [-8.632410696873308, 41.15307516201754], [-8.632421872744453, 41.15294961973167], [-8.632509230803905, 41.152816254336], [-8.632568276656455, 41.15277061952883], [-8.632697544232702, 41.152719024257046], [-8.632813400763572, 41.15268791808236], [-8.632813400763572, 41.15268791808236], [-8.632892004390627, 41.15265923334641], [-8.632892004390627, 41.15265923334641], [-8.633197478201929, 41.15262049032645], [-8.634169406462522, 41.15249699695029], [-8.634169406462522, 41.15249699695029], [-8.634478233035168, 41.1524541561109], [-8.634478233035168, 41.1524541561109], [-8.634850575808821, 41.15239995313585], [-8.635824739243644, 41.15245601875609], [-8.63615982911348, 41.15250575138269], [-8.637535578851452, 41.15282370491677], [-8.637535578851452, 41.15282370491677], [-8.638220287223614, 41.15297793193857], [-8.638793236884323, 41.15311465009558], [-8.638793236884323, 41.15311465009558], [-8.640269569462603, 41.15345979824945], [-8.640269569462603, 41.15345979824945], [-8.640456206510727, 41.15349220827577], [-8.641078516268996, 41.15366152272362], [-8.641755960324913, 41.15386417852039], [-8.641755960324913, 41.15386417852039], [-8.642387955838172, 41.15406068758802], [-8.642440854961594, 41.154077078865704], [-8.642440854961594, 41.154077078865704], [-8.643847710874253, 41.15449524271105], [-8.643847710874253, 41.15449524271105], [-8.643887571481338, 41.154504742201524], [-8.645943559243014, 41.154333378843965], [-8.64602588816045, 41.154325369469646], [-8.64602588816045, 41.154325369469646], [-8.645987331405, 41.154025669858434], [-8.64597708685645, 41.153880197269025], [-8.64597708685645, 41.153880197269025], [-8.645965538456267, 41.15382115141648], [-8.645945794417242, 41.15376229182844], [-8.645945794417242, 41.15376229182844], [-8.645927540494371, 41.15371423558252], [-8.645927540494371, 41.15371423558252], [-8.645706817039255, 41.153442661913694], [-8.645706817039255, 41.153442661913694], [-8.645544953172168, 41.153281729369205], [-8.645189374205232, 41.15303083106199], [-8.64524897885134, 41.15269443734052], [-8.645259037135371, 41.15265755696574], [-8.645259037135371, 41.15265755696574], [-8.64524897885134, 41.15269443734052], [-8.645189374205232, 41.15303083106199], [-8.645544953172168, 41.153281729369205], [-8.645706817039255, 41.153442661913694], [-8.645706817039255, 41.153442661913694], [-8.645927540494371, 41.15371423558252], [-8.645927540494371, 41.15371423558252], [-8.645945794417242, 41.15376229182844], [-8.645945794417242, 41.15376229182844], [-8.645965538456267, 41.15382115141648], [-8.64597708685645, 41.153880197269025], [-8.64597708685645, 41.153880197269025], [-8.645987331405, 41.154025669858434], [-8.64602588816045, 41.154325369469646], [-8.64602588816045, 41.154325369469646], [-8.646846197102507, 41.1542644609719], [-8.648067161025118, 41.15426315712027], [-8.648067161025118, 41.15426315712027], [-8.648175008181669, 41.154421668226014], [-8.648175008181669, 41.154421668226014], [-8.648015193224293, 41.154665861010535], [-8.648015193224293, 41.154665861010535], [-8.647995076656231, 41.15478805053505], [-8.648024878979285, 41.15488379049786], [-8.64803400594072, 41.15492868024696], [-8.64803400594072, 41.15492868024696], [-8.648062131883103, 41.15495419848608], [-8.648062131883103, 41.15495419848608], [-8.64805859285724, 41.155001695938445], [-8.648202389065975, 41.15529059220755], [-8.648263856357273, 41.155391920105934], [-8.648263856357273, 41.155391920105934], [-8.648459434102314, 41.15580878009965], [-8.648502274941704, 41.15598964294768], [-8.648573055458957, 41.15642419807071], [-8.648573055458957, 41.15642419807071], [-8.64861515124027, 41.15676524840516], [-8.648686863080119, 41.15694592498867], [-8.648686863080119, 41.15694592498867], [-8.649005375407757, 41.15746131891298], [-8.649005375407757, 41.15746131891298], [-8.649085469150963, 41.15758779252144], [-8.649085469150963, 41.15758779252144], [-8.649439930530784, 41.158190730769725], [-8.649439930530784, 41.158190730769725], [-8.649430058511273, 41.158239904602766], [-8.649439744266266, 41.1582890784358], [-8.649479232344312, 41.15846323576115], [-8.649479232344312, 41.15846323576115], [-8.649506426964098, 41.158576298324235], [-8.64947345814422, 41.158803727302036], [-8.649407334239944, 41.15900135395679], [-8.649144701268034, 41.159573186030386], [-8.64907392075078, 41.1596475055735], [-8.648921183845129, 41.159695561819426], [-8.648750565545646, 41.15966818093512], [-8.648675687208973, 41.15961863457304], [-8.648628562285644, 41.159489366996795], [-8.64865612943447, 41.15939064680168], [-8.64874777157786, 41.15932284651673], [-8.64880495478522, 41.159302357419634], [-8.648896224399572, 41.15929304419368], [-8.648983582459023, 41.15930459259386], [-8.649081743860581, 41.15932973830394], [-8.649081743860581, 41.15932973830394], [-8.649476065847487, 41.159453045415574], [-8.649476065847487, 41.159453045415574], [-8.649660281456864, 41.15955269693328], [-8.649815253536744, 41.159662592999545], [-8.64999127350728, 41.15983116238932], [-8.650085895882977, 41.159988742172466], [-8.650137304890244, 41.16011018663891], [-8.650137304890244, 41.16011018663891], [-8.650183498490978, 41.160250071292744], [-8.650293580821758, 41.16076472015898], [-8.650306060544537, 41.16093422087135], [-8.650241985549972, 41.16124379250207], [-8.650171763826275, 41.16131028893538], [-8.650076210127985, 41.16135163965862], [-8.650076210127985, 41.16135163965862], [-8.649719141044896, 41.16129184874799], [-8.649719141044896, 41.16129184874799], [-8.648900322218992, 41.161153640474836], [-8.648900322218992, 41.161153640474836], [-8.647752187723343, 41.16095824899431], [-8.64730235890975, 41.160885605831865], [-8.64730235890975, 41.160885605831865], [-8.6471857573208, 41.160932358226155], [-8.6471857573208, 41.160932358226155], [-8.646664775460916, 41.16084742160545], [-8.646664775460916, 41.16084742160545], [-8.646554320601098, 41.16089231135455], [-8.646554320601098, 41.16089231135455], [-8.646336577378285, 41.16158484283652], [-8.646336577378285, 41.16158484283652], [-8.646324656449064, 41.16158279392681], [-8.646289638719477, 41.16158782306882], [-8.646262071570652, 41.16161669406928], [-8.646260953983537, 41.161625634766196], [-8.646260953983537, 41.161625634766196], [-8.645703464277911, 41.16153008106791], [-8.644893586148923, 41.161387774975324], [-8.644483990471452, 41.16119424613999], [-8.644221916293098, 41.1611435821908], [-8.644073277206866, 41.161130357409945], [-8.643928177146499, 41.16117561968809], [-8.643798350776695, 41.16122777375343], [-8.643798350776695, 41.16122777375343], [-8.643855533984055, 41.16129650536097], [-8.643625869832022, 41.162144008922816], [-8.643625869832022, 41.162144008922816], [-8.64358936198628, 41.162198770691425], [-8.643315553143223, 41.163159336816356], [-8.643304191007559, 41.16327631093434], [-8.643304191007559, 41.16327631093434], [-8.643216646683587, 41.16355850168076], [-8.643216646683587, 41.16355850168076], [-8.642799041631797, 41.164873529185506], [-8.642799041631797, 41.164873529185506], [-8.642774640979797, 41.16495101522545], [-8.642723790766086, 41.165100213105234], [-8.642723790766086, 41.165100213105234], [-8.641917079133922, 41.16496871035476], [-8.64165463242653, 41.16492214422499]]
            }, "fillStyle": "red"
        }, {
            "geometry": {
                "type": "LineString",
                "coordinates": [[-8.626113466012034, 41.15231408519255], [-8.626133023786538, 41.15238374812269], [-8.6262058532135, 41.152645636036524], [-8.6262058532135, 41.152645636036524], [-8.626254095723944, 41.15263166619759], [-8.626436076159091, 41.15257932586773], [-8.62668492555659, 41.152508917879516], [-8.62668492555659, 41.152508917879516], [-8.627034916587954, 41.15240758998113], [-8.627172566067559, 41.15238914979374], [-8.627172566067559, 41.15238914979374], [-8.627336665108874, 41.15239995313585], [-8.628582029683486, 41.15246887100791], [-8.628742962227976, 41.152478184233864], [-8.628742962227976, 41.152478184233864], [-8.628965362063767, 41.152490477692126], [-8.630101575630194, 41.15255399389313], [-8.630101575630194, 41.15255399389313], [-8.630490309681527, 41.15257560057734], [-8.630617528348063, 41.15258342368715], [-8.630617528348063, 41.15258342368715], [-8.630806773099454, 41.152591991855026], [-8.630991547502388, 41.152600560022904], [-8.630991547502388, 41.152600560022904], [-8.631357371017874, 41.15261639250703], [-8.631357371017874, 41.15261639250703], [-8.631495765555556, 41.152626637055576], [-8.632241196160939, 41.15267655594669], [-8.632241196160939, 41.15267655594669], [-8.632465831170958, 41.15261564744895], [-8.632556541991752, 41.15251674098931], [-8.632556541991752, 41.15251674098931], [-8.632598078979509, 41.15241969717487], [-8.632655448451388, 41.15217364174516], [-8.632732003168732, 41.15203934502689], [-8.632732003168732, 41.15203934502689], [-8.632783784705039, 41.15187412839847], [-8.632908395668307, 41.151731822305884], [-8.633543185149353, 41.15133153985437], [-8.633742488184776, 41.151238407594825], [-8.634018345937543, 41.15117992053583], [-8.634561679539718, 41.151146579186914], [-8.634561679539718, 41.151146579186914], [-8.635699383222297, 41.151080827811676], [-8.635699383222297, 41.151080827811676], [-8.636431961575864, 41.15108213166331], [-8.63716304981328, 41.15109852294099], [-8.637621446794752, 41.15112515876722], [-8.637621446794752, 41.15112515876722], [-8.63805190409836, 41.15115347097412], [-8.63805190409836, 41.15115347097412], [-8.639494895327722, 41.151282924814886], [-8.639494895327722, 41.151282924814886], [-8.640631481423188, 41.1513943109973], [-8.640631481423188, 41.1513943109973], [-8.641484572920604, 41.15147645365022], [-8.641484572920604, 41.15147645365022], [-8.641551255618436, 41.1514840904955], [-8.641733422318103, 41.151505138386156], [-8.642032563135755, 41.15157349746466], [-8.642312146178904, 41.15164297413028], [-8.642312146178904, 41.15164297413028], [-8.642575151679855, 41.151801298971506], [-8.642575151679855, 41.151801298971506], [-8.642834804419461, 41.15195943754821], [-8.643335669711284, 41.152295831269676], [-8.643675416194098, 41.15256572855783], [-8.643940284340239, 41.15280396087775], [-8.64417665401496, 41.1530621235012], [-8.64441507259939, 41.153369459957695], [-8.644713840888006, 41.15385207132665], [-8.644871048142114, 41.154176357854375], [-8.644871048142114, 41.154176357854375], [-8.644934378078604, 41.15431922274051], [-8.645010746531428, 41.154505859788635], [-8.645010746531428, 41.154505859788635], [-8.64523053866395, 41.15505012471341], [-8.64523053866395, 41.15505012471341], [-8.645325906097723, 41.15528444547842], [-8.645674220748415, 41.156138282033915], [-8.645800321827837, 41.156429227212726], [-8.645800321827837, 41.156429227212726], [-8.645881346893638, 41.156594071312114], [-8.645950637294739, 41.156728554294894], [-8.645950637294739, 41.156728554294894], [-8.646218299408666, 41.15718024575368], [-8.64665602102852, 41.1577669789888], [-8.647915169177544, 41.15925355611563], [-8.648455522547414, 41.15989430606129], [-8.648455522547414, 41.15989430606129], [-8.648535988819658, 41.15999302625641], [-8.648813895482135, 41.16036890805592], [-8.648940182826076, 41.160578641904415], [-8.648940182826076, 41.160578641904415], [-8.649050078892337, 41.16083363803104], [-8.649158298577927, 41.16113762172619], [-8.649238951114691, 41.16161054734015], [-8.6492331769146, 41.16198885057842], [-8.649213246611057, 41.16214419518734], [-8.649083047712216, 41.16264114892426], [-8.648993827007573, 41.16285870588255], [-8.648993827007573, 41.16285870588255], [-8.648844815392303, 41.16313456363532], [-8.648682206467141, 41.1633657179035], [-8.648400760778802, 41.163701739095934], [-8.647933795629452, 41.1640761307793], [-8.647595539262792, 41.16428921738913], [-8.647113114158357, 41.164547380012586], [-8.647113114158357, 41.164547380012586], [-8.646257787486713, 41.16492233048951], [-8.646257787486713, 41.16492233048951], [-8.645906678868235, 41.16507823389198], [-8.645906678868235, 41.16507823389198], [-8.645504720036046, 41.16515963148682], [-8.645094938094056, 41.165320936560356], [-8.645094938094056, 41.165320936560356], [-8.644367947676061, 41.16562343013935], [-8.643925941972268, 41.165811929832664], [-8.643925941972268, 41.165811929832664], [-8.64373036422723, 41.165891092253275], [-8.643528453488539, 41.16596485300283], [-8.643388196305667, 41.16599912567435], [-8.643083840081479, 41.16603581978461], [-8.642932034498424, 41.16603097690711], [-8.642238385429346, 41.165898170305006], [-8.641245036749059, 41.16593765838305], [-8.641117818082522, 41.16592946274421], [-8.640921681543924, 41.16588047517569], [-8.640807873922762, 41.1658376343363], [-8.640667244210853, 41.165759030709246], [-8.640500351201752, 41.16566105557221], [-8.640500351201752, 41.16566105557221], [-8.64044745207833, 41.16561895979089], [-8.640182583932189, 41.16540829461981], [-8.640028170645866, 41.165223333952355], [-8.639973036348216, 41.16515534740289], [-8.639973036348216, 41.16515534740289], [-8.639999858438966, 41.165096301550335], [-8.639999858438966, 41.165096301550335], [-8.640150918963945, 41.16499665003263], [-8.640312596566512, 41.164900537540774], [-8.640466451059277, 41.164859559346574], [-8.640600934042057, 41.16485266755937], [-8.640728338973112, 41.164859559346574], [-8.640728338973112, 41.164859559346574], [-8.641044616126521, 41.16492177169595], [-8.641044616126521, 41.16492177169595], [-8.641331277221395, 41.16496051471592], [-8.641971095844458, 41.165069665724104], [-8.642108186530505, 41.16509350758255], [-8.642108186530505, 41.16509350758255], [-8.642693243384956, 41.165195021745454]]
            }, "fillStyle": "blue"
        }, {
            "geometry": {
                "type": "LineString",
                "coordinates": [[-8.630741766782293, 41.154820460561375], [-8.630887984429776, 41.15471112328867], [-8.630887984429776, 41.15471112328867], [-8.630920580720616, 41.15468690890119], [-8.631063818135793, 41.15458185571242], [-8.631063818135793, 41.15458185571242], [-8.631743683630459, 41.15406906949138], [-8.631743683630459, 41.15406906949138], [-8.631778887624566, 41.154042433665154], [-8.631778887624566, 41.154042433665154], [-8.631866245684018, 41.1539755647028], [-8.631866245684018, 41.1539755647028], [-8.631975582956722, 41.15388764784979], [-8.631975582956722, 41.15388764784979], [-8.63205772560964, 41.15379730955804], [-8.632142475965823, 41.15369411901446], [-8.632199845437702, 41.15360396698722], [-8.632199845437702, 41.15360396698722], [-8.632249578064298, 41.15347767964328], [-8.632317750878284, 41.15327446505296], [-8.632360591717674, 41.152946825763884], [-8.632446832190011, 41.15278738333555], [-8.632446832190011, 41.15278738333555], [-8.632631047799388, 41.15256107194486], [-8.632631047799388, 41.15256107194486], [-8.63273442460748, 41.15217960220977], [-8.632732003168732, 41.15203934502689], [-8.632732003168732, 41.15203934502689], [-8.632783784705039, 41.15187412839847], [-8.632908395668307, 41.151731822305884], [-8.633543185149353, 41.15133153985437], [-8.633742488184776, 41.151238407594825], [-8.634018345937543, 41.15117992053583], [-8.634561679539718, 41.151146579186914], [-8.634561679539718, 41.151146579186914], [-8.635699383222297, 41.151080827811676], [-8.635699383222297, 41.151080827811676], [-8.636431961575864, 41.15108213166331], [-8.63716304981328, 41.15109852294099], [-8.637621446794752, 41.15112515876722], [-8.637621446794752, 41.15112515876722], [-8.63805190409836, 41.15115347097412], [-8.63805190409836, 41.15115347097412], [-8.639494895327722, 41.151282924814886], [-8.639494895327722, 41.151282924814886], [-8.640631481423188, 41.1513943109973], [-8.640631481423188, 41.1513943109973], [-8.641484572920604, 41.15147645365022], [-8.641484572920604, 41.15147645365022], [-8.641551255618436, 41.1514840904955], [-8.641733422318103, 41.151505138386156], [-8.642032563135755, 41.15157349746466], [-8.642312146178904, 41.15164297413028], [-8.642312146178904, 41.15164297413028], [-8.642575151679855, 41.151801298971506], [-8.642575151679855, 41.151801298971506], [-8.642834804419461, 41.15195943754821], [-8.643335669711284, 41.152295831269676], [-8.643675416194098, 41.15256572855783], [-8.643940284340239, 41.15280396087775], [-8.64417665401496, 41.1530621235012], [-8.64441507259939, 41.153369459957695], [-8.644713840888006, 41.15385207132665], [-8.644871048142114, 41.154176357854375], [-8.644871048142114, 41.154176357854375], [-8.644934378078604, 41.15431922274051], [-8.645010746531428, 41.154505859788635], [-8.645010746531428, 41.154505859788635], [-8.64523053866395, 41.15505012471341], [-8.64523053866395, 41.15505012471341], [-8.645325906097723, 41.15528444547842], [-8.645674220748415, 41.156138282033915], [-8.645800321827837, 41.156429227212726], [-8.645800321827837, 41.156429227212726], [-8.645881346893638, 41.156594071312114], [-8.645950637294739, 41.156728554294894], [-8.645950637294739, 41.156728554294894], [-8.646218299408666, 41.15718024575368], [-8.64665602102852, 41.1577669789888], [-8.647915169177544, 41.15925355611563], [-8.648455522547414, 41.15989430606129], [-8.648455522547414, 41.15989430606129], [-8.648535988819658, 41.15999302625641], [-8.648813895482135, 41.16036890805592], [-8.648940182826076, 41.160578641904415], [-8.648940182826076, 41.160578641904415], [-8.649050078892337, 41.16083363803104], [-8.649158298577927, 41.16113762172619], [-8.649238951114691, 41.16161054734015], [-8.6492331769146, 41.16198885057842], [-8.649213246611057, 41.16214419518734], [-8.649083047712216, 41.16264114892426], [-8.648993827007573, 41.16285870588255], [-8.648993827007573, 41.16285870588255], [-8.648844815392303, 41.16313456363532], [-8.648682206467141, 41.1633657179035], [-8.648400760778802, 41.163701739095934], [-8.647933795629452, 41.1640761307793], [-8.647595539262792, 41.16428921738913], [-8.647113114158357, 41.164547380012586], [-8.647113114158357, 41.164547380012586], [-8.646257787486713, 41.16492233048951], [-8.646257787486713, 41.16492233048951], [-8.645906678868235, 41.16507823389198], [-8.645906678868235, 41.16507823389198], [-8.645504720036046, 41.16515963148682], [-8.645094938094056, 41.165320936560356], [-8.645094938094056, 41.165320936560356], [-8.644367947676061, 41.16562343013935], [-8.643925941972268, 41.165811929832664], [-8.643925941972268, 41.165811929832664], [-8.64373036422723, 41.165891092253275], [-8.643528453488539, 41.16596485300283], [-8.643388196305667, 41.16599912567435], [-8.643083840081479, 41.16603581978461], [-8.642932034498424, 41.16603097690711], [-8.642238385429346, 41.165898170305006], [-8.641245036749059, 41.16593765838305], [-8.641117818082522, 41.16592946274421], [-8.640921681543924, 41.16588047517569], [-8.640807873922762, 41.1658376343363], [-8.640667244210853, 41.165759030709246], [-8.640500351201752, 41.16566105557221], [-8.640500351201752, 41.16566105557221], [-8.64044745207833, 41.16561895979089], [-8.640182583932189, 41.16540829461981], [-8.640028170645866, 41.165223333952355], [-8.639973036348216, 41.16515534740289], [-8.639973036348216, 41.16515534740289], [-8.639999858438966, 41.165096301550335], [-8.639999858438966, 41.165096301550335], [-8.640150918963945, 41.16499665003263], [-8.640312596566512, 41.164900537540774], [-8.640466451059277, 41.164859559346574], [-8.640600934042057, 41.16485266755937], [-8.640728338973112, 41.164859559346574], [-8.640728338973112, 41.164859559346574], [-8.641044616126521, 41.16492177169595], [-8.641044616126521, 41.16492177169595], [-8.641331277221395, 41.16496051471592], [-8.641971095844458, 41.165069665724104], [-8.642108186530505, 41.16509350758255], [-8.642108186530505, 41.16509350758255], [-8.642693243384956, 41.165195021745454], [-8.642693243384956, 41.165195021745454], [-8.642723790766086, 41.165100213105234], [-8.642723790766086, 41.165100213105234], [-8.642774640979797, 41.16495101522545], [-8.642799041631797, 41.164873529185506]]
            }, "fillStyle": "blue"
        }, {
            "geometry": {
                "type": "LineString",
                "coordinates": [[-8.630887984429776, 41.15471112328867], [-8.630920580720616, 41.15468690890119], [-8.631063818135793, 41.15458185571242], [-8.631063818135793, 41.15458185571242], [-8.631743683630459, 41.15406906949138], [-8.631743683630459, 41.15406906949138], [-8.631778887624566, 41.154042433665154], [-8.631778887624566, 41.154042433665154], [-8.631866245684018, 41.1539755647028], [-8.631866245684018, 41.1539755647028], [-8.631975582956722, 41.15388764784979], [-8.631975582956722, 41.15388764784979], [-8.63205772560964, 41.15379730955804], [-8.632142475965823, 41.15369411901446], [-8.632199845437702, 41.15360396698722], [-8.632199845437702, 41.15360396698722], [-8.632311045355596, 41.15349667862423], [-8.632317378349246, 41.153481963727224], [-8.63238983524717, 41.1532778178143], [-8.63238983524717, 41.1532778178143], [-8.632410696873308, 41.15307516201754], [-8.632421872744453, 41.15294961973167], [-8.632509230803905, 41.152816254336], [-8.632568276656455, 41.15277061952883], [-8.632697544232702, 41.152719024257046], [-8.632813400763572, 41.15268791808236], [-8.632813400763572, 41.15268791808236], [-8.632892004390627, 41.15265923334641], [-8.632892004390627, 41.15265923334641], [-8.633197478201929, 41.15262049032645], [-8.634169406462522, 41.15249699695029], [-8.634169406462522, 41.15249699695029], [-8.634478233035168, 41.1524541561109], [-8.634478233035168, 41.1524541561109], [-8.634850575808821, 41.15239995313585], [-8.635824739243644, 41.15245601875609], [-8.63615982911348, 41.15250575138269], [-8.637535578851452, 41.15282370491677], [-8.637535578851452, 41.15282370491677], [-8.638220287223614, 41.15297793193857], [-8.638793236884323, 41.15311465009558], [-8.638793236884323, 41.15311465009558], [-8.640269569462603, 41.15345979824945], [-8.640269569462603, 41.15345979824945], [-8.640456206510727, 41.15349220827577], [-8.641078516268996, 41.15366152272362], [-8.641755960324913, 41.15386417852039], [-8.641755960324913, 41.15386417852039], [-8.642387955838172, 41.15406068758802], [-8.642440854961594, 41.154077078865704], [-8.642440854961594, 41.154077078865704], [-8.643847710874253, 41.15449524271105], [-8.643847710874253, 41.15449524271105], [-8.643887571481338, 41.154504742201524], [-8.645943559243014, 41.154333378843965], [-8.64602588816045, 41.154325369469646], [-8.64602588816045, 41.154325369469646], [-8.645987331405, 41.154025669858434], [-8.64597708685645, 41.153880197269025], [-8.64597708685645, 41.153880197269025], [-8.645965538456267, 41.15382115141648], [-8.645945794417242, 41.15376229182844], [-8.645945794417242, 41.15376229182844], [-8.645927540494371, 41.15371423558252], [-8.645927540494371, 41.15371423558252], [-8.645706817039255, 41.153442661913694], [-8.645706817039255, 41.153442661913694], [-8.645544953172168, 41.153281729369205], [-8.645189374205232, 41.15303083106199], [-8.64524897885134, 41.15269443734052], [-8.645259037135371, 41.15265755696574], [-8.645259037135371, 41.15265755696574], [-8.64524897885134, 41.15269443734052], [-8.645189374205232, 41.15303083106199], [-8.645544953172168, 41.153281729369205], [-8.645706817039255, 41.153442661913694], [-8.645706817039255, 41.153442661913694], [-8.645927540494371, 41.15371423558252], [-8.645927540494371, 41.15371423558252], [-8.645945794417242, 41.15376229182844], [-8.645945794417242, 41.15376229182844], [-8.645965538456267, 41.15382115141648], [-8.64597708685645, 41.153880197269025], [-8.64597708685645, 41.153880197269025], [-8.645987331405, 41.154025669858434], [-8.64602588816045, 41.154325369469646], [-8.64602588816045, 41.154325369469646], [-8.646846197102507, 41.1542644609719], [-8.648067161025118, 41.15426315712027], [-8.648067161025118, 41.15426315712027], [-8.648175008181669, 41.154421668226014], [-8.648175008181669, 41.154421668226014], [-8.648015193224293, 41.154665861010535], [-8.648015193224293, 41.154665861010535], [-8.647995076656231, 41.15478805053505], [-8.648024878979285, 41.15488379049786], [-8.64803400594072, 41.15492868024696], [-8.64803400594072, 41.15492868024696], [-8.648062131883103, 41.15495419848608], [-8.648062131883103, 41.15495419848608], [-8.64805859285724, 41.155001695938445], [-8.648202389065975, 41.15529059220755], [-8.648263856357273, 41.155391920105934], [-8.648263856357273, 41.155391920105934], [-8.648459434102314, 41.15580878009965], [-8.648502274941704, 41.15598964294768], [-8.648573055458957, 41.15642419807071], [-8.648573055458957, 41.15642419807071], [-8.64861515124027, 41.15676524840516], [-8.648686863080119, 41.15694592498867], [-8.648686863080119, 41.15694592498867], [-8.649005375407757, 41.15746131891298], [-8.649005375407757, 41.15746131891298], [-8.649085469150963, 41.15758779252144], [-8.649085469150963, 41.15758779252144], [-8.649439930530784, 41.158190730769725], [-8.649439930530784, 41.158190730769725], [-8.649430058511273, 41.158239904602766], [-8.649439744266266, 41.1582890784358], [-8.649479232344312, 41.15846323576115], [-8.649479232344312, 41.15846323576115], [-8.649506426964098, 41.158576298324235], [-8.64947345814422, 41.158803727302036], [-8.649407334239944, 41.15900135395679], [-8.649144701268034, 41.159573186030386], [-8.64907392075078, 41.1596475055735], [-8.648921183845129, 41.159695561819426], [-8.648750565545646, 41.15966818093512], [-8.648675687208973, 41.15961863457304], [-8.648628562285644, 41.159489366996795], [-8.64865612943447, 41.15939064680168], [-8.64874777157786, 41.15932284651673], [-8.64880495478522, 41.159302357419634], [-8.648896224399572, 41.15929304419368], [-8.648983582459023, 41.15930459259386], [-8.649081743860581, 41.15932973830394], [-8.649081743860581, 41.15932973830394], [-8.649476065847487, 41.159453045415574], [-8.649476065847487, 41.159453045415574], [-8.649660281456864, 41.15955269693328], [-8.649815253536744, 41.159662592999545], [-8.64999127350728, 41.15983116238932], [-8.650085895882977, 41.159988742172466], [-8.650137304890244, 41.16011018663891], [-8.650137304890244, 41.16011018663891], [-8.650183498490978, 41.160250071292744], [-8.650293580821758, 41.16076472015898], [-8.650306060544537, 41.16093422087135], [-8.650241985549972, 41.16124379250207], [-8.650171763826275, 41.16131028893538], [-8.650076210127985, 41.16135163965862], [-8.650076210127985, 41.16135163965862], [-8.649719141044896, 41.16129184874799], [-8.649719141044896, 41.16129184874799], [-8.648900322218992, 41.161153640474836], [-8.648900322218992, 41.161153640474836], [-8.647752187723343, 41.16095824899431], [-8.64730235890975, 41.160885605831865], [-8.64730235890975, 41.160885605831865], [-8.6471857573208, 41.160932358226155], [-8.6471857573208, 41.160932358226155], [-8.646664775460916, 41.16084742160545], [-8.646664775460916, 41.16084742160545], [-8.646554320601098, 41.16089231135455], [-8.646554320601098, 41.16089231135455], [-8.646336577378285, 41.16158484283652], [-8.646336577378285, 41.16158484283652], [-8.646324656449064, 41.16158279392681], [-8.646289638719477, 41.16158782306882], [-8.646262071570652, 41.16161669406928], [-8.646260953983537, 41.161625634766196], [-8.646260953983537, 41.161625634766196], [-8.645703464277911, 41.16153008106791], [-8.644893586148923, 41.161387774975324], [-8.644483990471452, 41.16119424613999], [-8.644221916293098, 41.1611435821908], [-8.644073277206866, 41.161130357409945], [-8.643928177146499, 41.16117561968809], [-8.643798350776695, 41.16122777375343], [-8.643798350776695, 41.16122777375343], [-8.643855533984055, 41.16129650536097], [-8.643625869832022, 41.162144008922816], [-8.643625869832022, 41.162144008922816], [-8.64358936198628, 41.162198770691425], [-8.643315553143223, 41.163159336816356], [-8.643304191007559, 41.16327631093434], [-8.643304191007559, 41.16327631093434], [-8.643216646683587, 41.16355850168076], [-8.643216646683587, 41.16355850168076], [-8.642799041631797, 41.164873529185506], [-8.642799041631797, 41.164873529185506], [-8.642774640979797, 41.16495101522545], [-8.642723790766086, 41.165100213105234], [-8.642723790766086, 41.165100213105234], [-8.641917079133922, 41.16496871035476], [-8.64165463242653, 41.16492214422499]]
            }, "fillStyle": "blue"
        }];


        let dataSet = new mapv.DataSet(data);

        let options = {
            fillStyle: 'rgba(255, 50, 50, 0.6)',
            shadowColor: 'rgba(255, 50, 50, 1)',
            shadowBlur: 30,
            globalCompositeOperation: 'lighter',
            methods: {
                click: function (item) {
                    // console.log(item);
                }
            },
            size: 5,
            draw: 'simple'
        };

        let mapvLayer = new mapv.baiduMapLayer(map, dataSet, options);

        dataSet.set(data); // 修改数据

        // mapvLayer.show(); // 显示图层
        // mapvLayer.hide(); // 删除图层
    });
</script>

</body>
</html>
